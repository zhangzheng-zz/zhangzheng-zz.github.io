!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Validator=t():e.Validator=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(8);t.default=class{constructor(e){this.rules=null,this.define(e)}define(e){if(!e)throw new Error("无法配置,没有校验规则的实例");if("object"!=typeof e||Array.isArray(e))throw new Error("校验规则必须为一个对象");let t,r;for(t in this.rules={},e)if(e.hasOwnProperty(t)){if(r=e[t],"object"!=typeof r)throw new Error(Object(n.format)("%s 格式错误（必须是一个对象）",t));this.rules[t]=r}}validate(e,t={reportEmptyError:!0,entiretyValidate:!0},r){const n=Object.keys(this.rules);let a;const o={};let i=[];for(const r of n){a=e[r];let n=this.rules[r];const s=r,u=this.getType(n),f=this.getValidationMethod(n,u);o[r]={field:s,type:u,rule:n,value:a,source:e,options:t},i.push(f(o[r]))}return Promise.all(i.map(async e=>{try{return await e}catch(e){return e}}))}getType(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!=typeof e.validator&&e.type&&!a.default.hasOwnProperty(e.type))throw new Error(Object(n.format)("不支持的type类型: %s / validator不是一个方法: ",e.type));return e.type||"string"}getValidationMethod(e,t){if("function"==typeof e.validator)return e.validator;const r=Object.keys(e);return 1===r.length&&"required"===r[0]?a.default.string:a.default[t]||!1}static extend(e,t){if(void 0===t||void 0===e)throw new Error("无法拓展一个方法，请传入一个类型和一个方法");if("function"!=typeof t)throw new Error(Object(n.format)("无法拓展一个方法，因为%s不是一个方法",t));a.default[e]=t}}},function(e,t,r){"use strict";r.r(t),r.d(t,"format",(function(){return i})),r.d(t,"formatMessage",(function(){return s})),r.d(t,"rulesInterator",(function(){return u})),r.d(t,"NoHasField",(function(){return f})),r.d(t,"isEmptyValue",(function(){return c})),r.d(t,"withinErrorMargin",(function(){return l}));var n=r(2),a=r(4);const o=/%[sdj%]/g;function i(...e){let t=1;const r=e[0],n=e.length;if("function"==typeof r)return r.apply(null,e.slice(1));if("string"==typeof r){let a=String(r).replace(o,r=>{if("%%"===r)return"%";if(t>=n)return r;switch(r){case"%s":return String(e[t++]);case"%d":return Number(e[t++]);case"%j":try{return JSON.stringify(e[t++])}catch(e){return"[Circular]"}break;default:return r}});for(let r=e[t];t<n;r=e[++t])a+=" "+r;return a}return r}function s(e,t,r,n){return e?{message:!1,errorMessage:e,field:t,value:r,...n}:{message:!0,field:t,value:r,...n}}function u(e){const{rule:t,value:r,options:a,field:o}=e;for(let[r,a]of Object.entries(t))if("type"!==r&&"required"!==r){if(!n.default[r])throw new Error(i("%s 是不合法的规则字段",r));let t;if(t=n.default[r](e),!t.message)return t}}function f(e){const{rule:t,value:r,options:n,field:o}=e;if(t.hasOwnProperty("required")&&c(r)&&n.reportEmptyError)throw new Error(i(a.default.NoHasField.ERROR,o));if(t.hasOwnProperty("required")&&c(r))return s(i(a.default.NoHasField.REQUIRED,o))}function c(e){if(void 0===e)return!0}function l(e,t,r){let n,{precision:a}=r;if(c(a))n=2;else{if("number"!=typeof a)throw new Error("precision 不是一个数字！");if(!(a>=1&&a<=52))throw new Error("precision 仅限于1到52之间的数字");if(a%1!=0)throw new Error("precision 不是一个整数！");n=52-a}return Math.abs(e-t)<Number.EPSILON*Math.pow(2,n)}},function(e,t,r){"use strict";r.r(t);var n=r(3),a=r(5),o=r(6),i=r(7);t.default={isEmpty:o.default,min:n.default,max:a.default,hans:i.default}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);function o(e){let t,r,{value:i,field:s,rule:u,type:f,options:c}=e,l=0;switch("string"===f&&function(){for(let e=0;e<i.length;e++){let t=i.charCodeAt(e);t>=1&&t<=126||65376<=t&&t<=65439?l++:l+=2}}(),o="string"===f&&l<u.min||"number"===f&&i<u.min&&!Object(n.withinErrorMargin)(i,u.min,c)||"float"===f&&i<u.min&&!Object(n.withinErrorMargin)(i,u.min,c)||"integer"===f&&i<u.min&&!Object(n.withinErrorMargin)(i,u.min,c)||"array"===f&&i.length<u.min,t={len:l},f){case"string":r=Object(n.format)(a.default.RULES.MIN.STRING,s,u.min);break;case"number":r=Object(n.format)(a.default.RULES.MIN.NUMBER,s,u.min);break;case"float":r=Object(n.format)(a.default.RULES.MIN.FLOAT,s,u.min);break;case"integer":r=Object(n.format)(a.default.RULES.MIN.INTEGER,s,u.min);break;case"array":r=Object(n.format)(a.default.RULES.MIN.ARRAY,s,u.min);break;default:r=Object(n.format)(a.default.RULES.MIN.DEFAULT,s,u.min)}return o?Object(n.formatMessage)(r,s,i,t):Object(n.formatMessage)(null,s,i)}t.default=o},function(e,t,r){"use strict";r.r(t),t.default={TYPE:{STRING:"%s 不是一个字符串",NUMBER:"%s 不是一个数字",FLOAT:"%s 不是一个浮点型",INTEGER:"%s 不是一个整数",Email:"%s 不是一个正确的邮箱",ARRAY:"%s 不是一个数组",DATE:"%s 不是一个日期",float:"%s 不是一个 %s",regexp:"%s 不是一个有效的 %s",email:"%s 不是一个有效的 %s",url:"%s 不是一个有效的 %s",hex:"%s 不是一个有效的 %s"},RULES:{ISEMPTY:{DEFAULT:"%s 字段为空",STRING:"%s 字段为空",NUMBER:"%s 字段为 0",INTEGER:"%s 字段为 0",ARRAY:"%s 字段长度为空"},MAX:{DEFAULT:"%s 的长度超过 %s",STRING:"%s 的长度超过 %s",NUMBER:"%s 的值大于 %s",FLOAT:"%s 的值大于 %s",INTEGER:"%s 的值大于 %s",ARRAY:"%s 字段元素个数超过 %s"},MIN:{DEFAULT:"%s 的长度小于 %s",STRING:"%s 的长度小于 %s",NUMBER:"%s 的值小于 %s",FLOAT:"%s 的值小于 %s",INTEGER:"%s 的值小于 %s",ARRAY:"%s 字段元素个数小于 %s"},HANS:"%s 含有非汉字字符",range:"字段 %s 须小于 %s 到 %s 个字符"}}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);function o(e){let t,r,{value:i,field:s,rule:u,type:f,options:c}=e,l=0;switch("string"===f&&function(){for(let e=0;e<i.length;e++){let t=i.charCodeAt(e);t>=1&&t<=126||65376<=t&&t<=65439?l++:l+=2}}(),"date"===f&&function(){throw u.max,!1}(),o="string"===f&&l>u.max||"number"===f&&i>u.max&&!Object(n.withinErrorMargin)(i,u.max,c)||"float"===f&&i>u.max&&!Object(n.withinErrorMargin)(i,u.max,c)||"integer"===f&&i>u.max&&!Object(n.withinErrorMargin)(i,u.max,c)||"array"===f&&i.length>u.max,t={len:l},f){case"string":r=Object(n.format)(a.default.RULES.MAX.STRING,s,u.max);break;case"number":r=Object(n.format)(a.default.RULES.MAX.NUMBER,s,u.max);break;case"float":r=Object(n.format)(a.default.RULES.MAX.FLOAT,s,u.max);break;case"integer":r=Object(n.format)(a.default.RULES.MAX.INTEGER,s,u.max);break;case"array":r=Object(n.format)(a.default.RULES.MAX.ARRAY,s,u.max);break;default:r=Object(n.format)(a.default.RULES.MAX.DEFAULT,s,u.max)}return o?Object(n.formatMessage)(r,s,i,t):Object(n.formatMessage)(null,s,i)}t.default=o},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){let t,r,{value:o,field:i,type:s}=e;switch(t="string"===s&&!o.trim()||"number"===s&&0===o||"integer"===s&&0===o||"array"===s&&0===o.length,s){case"string":r=Object(n.format)(a.default.RULES.ISEMPTY.STRING,i);break;case"number":r=Object(n.format)(a.default.RULES.ISEMPTY.NUMBER,i);break;case"integer":r=Object(n.format)(a.default.RULES.ISEMPTY.INTEGER,i);break;case"array":r=Object(n.format)(a.default.RULES.ISEMPTY.ARRAY,i);break;default:r=Object(n.format)(a.default.RULES.ISEMPTY.DEFAULT,i)}return t?Object(n.formatMessage)(r,i,o):Object(n.formatMessage)(null,i,o)}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){let t,{value:r,field:o}=e;return t="string"==typeof r&&!/^[\u2E80-\u9FFF]+$/.test(r),t?Object(n.formatMessage)(Object(n.format)(a.default.RULES.HANS,o),o,r):Object(n.formatMessage)(null,o,r)}},function(e,t,r){"use strict";r.r(t);var n=r(9),a=r(10),o=r(11),i=r(12),s=r(13),u=r(14),f=r(15),c=r(16);t.default={string:n.default,number:a.default,integer:i.default,email:s.default,phone:u.default,float:o.default,array:f.default,date:c.default}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){const{value:t,field:r}=e;let o;return o=Object(n.NoHasField)(e),o?Promise.reject(o):Object(n.isEmptyValue)(t)||"string"==typeof t?(o=Object(n.rulesInterator)(e),o?Promise.reject(o):Promise.resolve(Object(n.formatMessage)(null,r,t))):Promise.reject(Object(n.formatMessage)(Object(n.format)(a.default.TYPE.STRING,t),r,t))}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){const{value:t,field:r}=e;let o;return o=Object(n.NoHasField)(e),o?Promise.reject(o):Object(n.isEmptyValue)(t)||"number"==typeof t?(o=Object(n.rulesInterator)(e),o?Promise.reject(o):Promise.resolve(Object(n.formatMessage)(null,r,t))):Promise.reject(Object(n.formatMessage)(Object(n.format)(a.default.TYPE.NUMBER,t),r,t))}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){const{value:t,field:r}=e;let o;if(o=Object(n.NoHasField)(e),o)return Promise.reject(o);if(!Object(n.isEmptyValue)(t)&&!function(e){return"number"==typeof e&&/^-?\d*\.\d+$/.test(e)}(t))return Promise.reject(Object(n.formatMessage)(Object(n.format)(a.default.TYPE.FLOAT,t),r,t));return o=Object(n.rulesInterator)(e),o?Promise.reject(o):Promise.resolve(Object(n.formatMessage)(null,r,t))}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){const{value:t,field:r}=e;let o;if(o=Object(n.NoHasField)(e),o)return Promise.reject(o);if(!Object(n.isEmptyValue)(t)&&!function(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}(t))return Promise.reject(Object(n.formatMessage)(Object(n.format)(a.default.TYPE.INTEGER,t),r,t));return o=Object(n.rulesInterator)(e),o?Promise.reject(o):Promise.resolve(Object(n.formatMessage)(null,r,t))}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){const{value:t,field:r}=e;let o;if(o=Object(n.NoHasField)(e),o)return Promise.reject(o);if(!Object(n.isEmptyValue)(t)&&!function(e){return/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/.test(e)}(t))return Promise.reject(Object(n.formatMessage)(Object(n.format)(a.default.TYPE.Email,t),r,t));return o=Object(n.rulesInterator)(e),o?Promise.reject(o):Promise.resolve(Object(n.formatMessage)(null,r,t))}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){const{value:t,field:r}=e;let o;if(o=Object(n.NoHasField)(e),o)return Promise.reject(o);if(!Object(n.isEmptyValue)(t)&&!function(e){return/^1[3456789]\d{9}$/.test(e)}(t))return Promise.reject(Object(n.formatMessage)(Object(n.format)(a.default.TYPE.Email,t),r,t));return o=Object(n.rulesInterator)(e),o?Promise.reject(o):Promise.resolve(Object(n.formatMessage)(null,r,t))}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){const{value:t,field:r}=e;let o;return o=Object(n.NoHasField)(e),o?Promise.reject(o):Object(n.isEmptyValue)(t)||Array.isArray(t)?(o=Object(n.rulesInterator)(e),o?Promise.reject(o):Promise.resolve(Object(n.formatMessage)(null,r,t))):Promise.reject(Object(n.formatMessage)(Object(n.format)(a.default.TYPE.ARRAY,t),r,t))}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=r(4);t.default=function(e){const{value:t,field:r,options:o,source:i}=e;let s,u,f,c,l,d,m,b,j,E,O;if(s=Object(n.NoHasField)(e),s)return Promise.reject(s);if(!Object(n.isEmptyValue)(t)&&!function(t){if(t instanceof Date)return!0;let r,n,a,i,s=o.inDateFormat&&o.inDateFormat;if(void 0===s||"include"===s)i=!0;else{if("exclude"!==s)throw new Error("inDateFormat 配置错误");i=!1}if(n=i?/^(\d+)[-///.](\d{1,2})[-///.](\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/:/^(\d+)[-///.](\d{1,2})[-///.](\d{1,2})$/,a=t.toString().match(n),null==a)return!1;if(a[2]=a[2]-1,r=i?new Date(a[1],a[2],a[3],a[4],a[5],a[6]):new Date(a[1],a[2],a[3]),r.getFullYear()!=a[1])return!1;if(r.getMonth()!=a[2])return!1;if(r.getDate()!=a[3])return!1;if(i){if(r.getHours()!=a[4])return!1;if(r.getMinutes()!=a[5])return!1;if(r.getSeconds()!=a[6])return!1}return e={...e,timestamp:r},!0}(t))return Promise.reject(Object(n.formatMessage)(Object(n.format)(a.default.TYPE.DATE,t),r,t));if(s=Object(n.rulesInterator)(e),s)return Promise.reject(s);let g=o.outDateFormat&&o.outDateFormat;switch(t instanceof Date?(f=t.getFullYear(),c=(t.getMonth()+1).toString().padStart(2,"0"),l=t.getDate().toString().padStart(2,"0"),d=t.getHours().toString().padStart(2,"0"),m=t.getMinutes().toString().padStart(2,"0"),b=t.getSeconds().toString().padStart(2,"0"),j=`${f}-${c}-${l} ${d}:${m}:${b}`):j=t,g){case"cross":O="-";break;case"point":O=".";break;case"skew":O="/";break;default:O="-"}return E=j.replace(/[-///.]/g,O),u={source:i[r]},Promise.resolve(Object(n.formatMessage)(null,r,E,u))}}]).default}));